# р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕Ир╕│р╕Щр╕зр╕Щр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М (Orders Fetching Conditions)

## ЁЯУЛ р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕лр╕ер╕▒р╕Бр╣Гр╕Щр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

### 1. р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓ (Time Range)
- **р╕Др╣Ир╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ**: р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕гр╕░р╕Ър╕╕ `date_from` р╣Бр╕ер╕░ `date_to` р╕Ир╕░р╕Фр╕╢р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕зр╕▒р╕Щр╕Щр╕╡р╣Й
  - `date_from`: р╕зр╕▒р╕Щр╕Щр╕╡р╣Й 00:00:00 (р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕зр╕▒р╕Щ)
  - `date_to`: р╣Ар╕зр╕ер╕▓р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
- **Field р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Бр╕гр╕нр╕З**: `create_time` (р╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М)
- **р╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╣Ар╕зр╕ер╕▓**: Unix timestamp р╕кр╕│р╕лр╕гр╕▒р╕Ъ Shopee API

### 2. р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Ир╕│р╕Щр╕зр╕Щ (Limit)
- **р╕Др╣Ир╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ**: 50 р╕гр╕▓р╕вр╕Бр╕▓р╕г
- **р╕Вр╕╡р╕Фр╕Ир╕│р╕Бр╕▒р╕Ф API**: р╕кр╕╣р╕Зр╕кр╕╕р╕Ф 50 р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Хр╣Ир╕нр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Б (Shopee API limitation)
- **р╕Юр╕▓р╕гр╕▓р╕бр╕┤р╣Ар╕Хр╕нр╕гр╣М**: `page_size` р╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Б API
- **Frontend limit**: р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕ер╕╖р╕нр╕Б 10, 20, 30, 40, 50 р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Др╕Фр╣Й

### 3. р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕кр╕Цр╕▓р╕Щр╕░ (Order Status)
- **р╕Др╣Ир╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ**: р╕Фр╕╢р╕Зр╕Чр╕╕р╕Бр╕кр╕Цр╕▓р╕Щр╕░ (р╣Др╕бр╣Ир╕Бр╕гр╕нр╕З)
- **р╕Бр╕▓р╕гр╕Бр╕гр╕нр╕З**: р╕гр╕░р╕Ър╕╕ `order_status` р╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕бр╕╖р╣Ир╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╕Цр╕▓р╕Щр╕░р╣Ар╕Йр╕Юр╕▓р╕░
- **р╕Вр╣Йр╕нр╕вр╕Бр╣Ар╕зр╣Йр╕Щ**: р╕Цр╣Йр╕▓ `order_status=ALL` р╕Ир╕░р╣Др╕бр╣Ир╕кр╣Ир╕Зр╕Юр╕▓р╕гр╕▓р╕бр╕┤р╣Ар╕Хр╕нр╕гр╣Мр╕Щр╕╡р╣Йр╣Др╕Ыр╕вр╕▒р╕З API

### 4. р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Зр╕ер╕│р╕Фр╕▒р╕Ъ (Sorting)
- **р╣Ар╕Бр╕Ур╕Ср╣Мр╣Ар╕гр╕╡р╕вр╕З**: `create_time` (р╣Ар╕зр╕ер╕▓р╕кр╕гр╣Йр╕▓р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М)
- **р╕ер╕│р╕Фр╕▒р╕Ъ**: р╕Ир╕▓р╕Бр╣Гр╕лр╕бр╣Ир╕кр╕╕р╕Фр╣Др╕Ыр╣Ар╕Бр╣Ир╕▓р╕кр╕╕р╕Ф (newest first)
- **р╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕г**: 
  1. API р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕бр╕▓ тЖТ р╣Ар╕гр╕╡р╕вр╕Зр╣Гр╕Щ PHP
  2. р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Ър╕Щ Frontend тЖТ р╣Ар╕гр╕╡р╕вр╕Зр╕нр╕╡р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╣Гр╕Щ JavaScript

## ЁЯФД р╕Бр╕▓р╕г Auto-Refresh (Polling)

### р╣Ар╕зр╕ер╕▓р╣Гр╕Щр╕Бр╕▓р╕гр╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- **р╣Ар╕Фр╕┤р╕б**: р╕Чр╕╕р╕Б 30 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ (30,000 ms)
- **р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ**: р╕Чр╕╕р╕Б 15 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ (15,000 ms) тЬЕ **р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╣Бр╕ер╣Йр╕з р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╣Йр╕▓р╕Щр╕Др╣Йр╕▓р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣И**

### р╕Бр╕гр╕░р╕Ър╕зр╕Щр╕Бр╕▓р╕г Polling
```javascript
function startRecentOrdersPolling(){
    if (recentOrdersPollingStarted) return;
    recentOrdersPollingStarted = true;
    setInterval(()=>{
        fetch(buildAPIUrl('getOrders','&limit='+recentLimit))
            .then(r=>r.json())
            .then(d=>{ 
                if(d.success && d.data.orders){ 
                    displayRecentOrders(d.data.orders); 
                    updateTimestamp(); 
                } 
            })
            .catch(()=>{});
            },15000); // тЖР р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕Ыр╣Зр╕Щ 15 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ (р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╣Йр╕▓р╕Щр╕Др╣Йр╕▓р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣И)
}
```

## ЁЯФз р╕Юр╕▓р╕гр╕▓р╕бр╕┤р╣Ар╕Хр╕нр╕гр╣М API

### Shopee API (`/api/v2/order/get_order_list`)
```php
$query = [
    'time_from'                => $date_from_ts,      // Unix timestamp start
    'time_to'                  => $date_to_ts,        // Unix timestamp end  
    'time_range_field'         => 'create_time',      // Field р╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Бр╕гр╕нр╕Зр╣Ар╕зр╕ер╕▓
    'page_size'                => $pageSize,          // р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕г (max 50)
    'response_optional_fields' => 'order_status'      // р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
];

// р╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕кр╕Цр╕▓р╕Щр╕░ (optional)
if(isset($_GET['order_status']) && $_GET['order_status'] !== '' && strtoupper($_GET['order_status']) !== 'ALL'){
    $query['order_status'] = $_GET['order_status'];
}
```

### Lazada API (`/orders/get`)
```php
$params = [
    'created_after'  => date('Y-m-d\T00:00:00+07:00'),  // ISO 8601 format
    'created_before' => date('Y-m-d\T23:59:59+07:00'),  // ISO 8601 format
    'limit'          => $limit,                          // р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕г
    'offset'         => 0                                // р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ
];
```

## ЁЯУК р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Фр╕╢р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

### р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З
- **Order ID**: р╕гр╕лр╕▒р╕кр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М
- **Product**: р╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓р╕лр╕гр╕╖р╕нр╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕г
- **Amount**: р╕вр╕нр╕Фр╣Ар╕Зр╕┤р╕Щ
- **Status**: р╕кр╕Цр╕▓р╕Щр╕░р╕нр╕нр╣Ар╕Фр╕нр╕гр╣М (confirmed, shipped, delivered, cancelled)
- **Created At**: р╕зр╕▒р╕Щр╣Ар╕зр╕ер╕▓р╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М

### р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕е
1. **API Response** тЖТ Raw data р╕Ир╕▓р╕Б platform
2. **Normalization** тЖТ р╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ
3. **Sorting** тЖТ р╣Ар╕гр╕╡р╕вр╕Зр╕Хр╕▓р╕бр╣Ар╕зр╕ер╕▓р╣Гр╕лр╕бр╣Ир╕кр╕╕р╕Ф
4. **Limiting** тЖТ р╕Ир╕│р╕Бр╕▒р╕Фр╕Ир╕│р╕Щр╕зр╕Щр╕Хр╕▓р╕б Frontend setting
5. **Display** тЖТ р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╣Гр╕Щ UI

## ЁЯОп р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

### р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ
- р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕гр╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З (10-50)
- р╣Ар╕ер╕╖р╕нр╕Б Platform р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Фр╕╣
- р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е Real-time р╕лр╕гр╕╖р╕н Mock data

### р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Щр╕▒р╕Бр╕Юр╕▒р╕Тр╕Щр╕▓
- р╕Ыр╕гр╕▒р╕Ър╣Ар╕зр╕ер╕▓ Polling (р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ: 15 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ - р╣Ар╕лр╕бр╕▓р╕░р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╣Йр╕▓р╕Щр╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣И)
- р╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Зр╕╖р╣Ир╕нр╕Щр╣Др╕Вр╕Бр╕▓р╕гр╕Бр╕гр╕нр╕З (р╕кр╕Цр╕▓р╕Щр╕░, р╕Кр╣Ир╕зр╕Зр╣Ар╕зр╕ер╕▓)
- р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З API timeout (р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ: 30 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡)

---

**р╕нр╕▒р╕Юр╣Ар╕Фр╕Чр╕ер╣Ир╕▓р╕кр╕╕р╕Ф**: р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Ар╕зр╕ер╕▓ Auto-refresh р╣Ар╕Ыр╣Зр╕Щ 15 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡ р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╣Йр╕▓р╕Щр╕Др╣Йр╕▓р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣И р╣Бр╕ер╣Йр╕з тЬЕ
